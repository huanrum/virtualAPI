!function(e,t){"object"==typeof exports&&"undefined"!=typeof module?module.exports=t():"function"==typeof define&&define.amd?define(t):e.ehr=e.$ehr=t()}(this,function(e,t){"use strict";function n(e,t){if("string"!=typeof(e=e||"")||/^\d+$/.test(e))return void("function"==typeof e&&window?(window.addEventListener("load",e),"function"==typeof t&&window.addEventListener("beforeunload",t)):"boolean"==typeof e?d.binding=e:/^\d+$/.test(e)?d.version=e:s(e,t));if(/\.(js|css|html)$/.test(e)||/^https?:\/\//.test(e))return void d.files.push(e);if(e=e.trim().replace(/_/g,"."),/^>/.test(e))return d.temp[e.slice(1)];if(!t){if(!Object.getOwnPropertyNames(d.data).length){var r=d.temp;d.temp={},Object.keys(r).sort(function(e,t){return e.length-t.length}).forEach(function(e){d.temp[e]=r[e]})}if(!e)return d.data;if(d.temp[e]){var o,i=e.split("."),a=i.pop(),c=d.data;for(t=d.temp[e];i.length;)o=i.shift(),c=c[o]=c[o]||{};if(!c[a]&&t)if("function"==typeof t||t instanceof Array&&"function"==typeof t[t.length-1]){var u=[];if("function"==typeof t){var f=t.toLocaleString().slice(t.toLocaleString().indexOf("(")+1,t.toLocaleString().indexOf(")"));u=f?f.split(","):[]}else{var l=t.pop();u=t,t=l}for(var p=0;p<u.length;p++)"self"===u[p].trim().toLocaleLowerCase()?u[p]=d.data[e.split(".")[0]]:u[p]=n(u[p].trim());c[a]=t.apply(t,u)}else c[a]=t}for(var v in d.temp)v!==e&&function(e,t){for(var n=0;n<t.length;n++)if(e[n]!==t[n])return!1;return!0}(v.split("."),e.split("."))&&n(v);for(var h=e.split("."),m=d.data;h.length>1;)m=m[h.shift()];return m[h.shift()]}if(/\.$/.test(e)){var y=t;e=e.slice(0,e.length-1),t=function(){return y}}d.temp[e]=t}function r(e){return e=e.replace(/\$\S*\$/,""),e.split(/\s+/).map(function(e){return e[0].toLocaleUpperCase()+e.slice(1)}).join("")}function o(){for(var e=0;e<arguments.length;e++)if(arguments[e])return arguments[e];for(var t=0;t<arguments.length;t++)if(void 0!==arguments[t])return arguments[t]}function i(e){var t=[];return function(n){if("function"==typeof n&&1===arguments.length)t.push(n);else{var r=arguments;t.forEach(function(t){t.apply(e,r)})}}}function a(e,t,r,o){function i(e,t,r){return n("menuAction")?function(){n("menuAction")(r,e,t)}:(t.style.display=new RegExp("#"+(o||"")+"/"+r).test(location.hash)?"block":"none",function(){Array.prototype.forEach.call(this.parentNode.parentNode.children,function(e){Array.prototype.forEach.call(e.getElementsByTagName("UL"),function(e){e.style.display="none"})}),t.style.display="none"===t.style.display?"block":"none"})}function c(e,o,i){var a=document.createElement("span");return a.innerHTML=n("filter")(e),n("filter.menu")&&(a.innerHTML=n("filter.menu")(a.innerHTML,e)),a.addEventListener("click",function(){location.hash!=="#"+i&&r(i,e)}),t[i]=o,a}var u=document.createElement("ul");return Object.keys(e).forEach(function(n){var f=document.createElement("div"),l=c(n,e[n],(o||"")+"/"+n.replace(/\$\S*\$/,""));if(u.appendChild(f),f.appendChild(l),Object.keys(e).length){var s=a(e[n],t,r,(o||"")+"/"+n.replace(/\$\S*\$/,""));f.appendChild(s),l.addEventListener("click",i(l,s,n.replace(/\$\S*\$/,"")))}}),u}function c(e,t){if(t in e)for(;e;){if(Object.getOwnPropertyDescriptor(e,t))return Object.getOwnPropertyDescriptor(e,t);e=e.__proto__}return{enumerable:!0}}function u(e,t){["push","pop","shift","unshift","sort"].forEach(function(n){Object.defineProperty(e,n,{configurable:!0,value:function(){var r=Array.prototype[n].apply(e,arguments);return t(e),r}})}),Object.defineProperty(e,"replace",{configurable:!0,value:function(){return e.length=0,Array.prototype.forEach.call(arguments,function(t){Array.prototype.push.apply(e,t||[])}),t(e),e}})}function f(e,t,n){function r(e,t){var r=c(e,t);Object.defineProperty(e,t,{configurable:!0,enumerable:r.enumerable,set:function(e){r.set?r.set(e):r.value=e,n()},get:function(){return o(r.get&&r.get(),r.value,l(e.__proto__,t))}})}t.replace(/\'((?!\').)*\'/g,"").split(/[+\-*\/%\|\&\(\)=\?\:,!><]/).filter(function(e){return!!e.trim()}).forEach(function(t){/\[.*\]/.test(t)&&t.match(/\[[0-9a-zA-Z\.]*\]/g).forEach(function(n){t=t.replace(n,"."+l(e,n.replace(/[\[\]]/g,"")))});var n=e;t.split(".").forEach(function(e){r(n,e.trim()),n=n[e]||{}})}),setTimeout(function(){n()},500)}function l(e,n,r){function o(e,t,n){t=t||"";var r=t.trim().split(".");if(e){if(e instanceof HTMLElement&&!r[0]in e&&e.hasAttribute(r[0])){var a=e.attributes[r[0]];return r[0]="value",o(a,r.join("."),n)}if(t instanceof Array){for(var c=0;c<t.length;c++)if("number"==typeof e[t[c]]||e[t[c]])return e[t[c]];return"object"!=typeof e?e:null}for(;r.length>1;)r[0].trim()?e=i(e,r.shift(),!0):r.shift();if(void 0===n)return i(e,r.shift(),!1);i(e,r.shift(),!0,n)}}function i(e,t,n,r){if(/\[\d+\]/.test(t)){var o=t.replace(/\[\d+\]/g,"");o&&(e=e[o]=e[o]||[]),Array.prototype.map.call(t.match(/\[\d+\]/g),function(t,o,i){if(t=t.replace("[","").replace("]",""),o<i.length-1)e=e[t]=e[t]||[];else{if(!n)return e[t];e=e[t]=void 0!==r?r:e[t]||{}}})}else{if(!n)return e[t];void 0===r?e[t]||(e[t]={}):e[t]=r,e=e[t]}return e}return/^[0-9a-zA-Z\._$@]*$/.test(n)?o(e,n,r):t(e,n.replace(/\s+/gm," "),r)}function s(t,r,o,a){function v(e,t,n){var r=n,o=n;return n instanceof Array||(r=Object.keys(n),o=Object.values(n)),o.forEach(function(n,o){var i=r[o],a=l(e,i);Object.defineProperty(e,i,{configurable:!0,enumerable:!0,set:function(e){l(t,n,e)},get:function(){return l(t,n)}}),Object.defineProperty(t,n,{configurable:!0,enumerable:!0,set:function(e){a=e},get:function(){return a}}),a instanceof Array&&u(a,function(t){e[i]=t})}),t}function h(e){if(!e.render){e.render=!0,setTimeout(function(){delete e.render},100);var t=n("control");Array.prototype.filter.call(e.attributes||[],function(e){return/\{\{.*\}\}/.test(e.value)||/^\[.+\]$/.test(e.name)||/^:.+$/.test(e.name)||/^\(.+\)$/.test(e.name)||/^@.+$/.test(e.name)}).sort(function(e,t){return/:/.test(t.name)-/:/.test(e.name)}).forEach(function(n){!/:/.test(n.name)&&!/^\[style\./.test(n.name)&&l(t,n.name.slice(1,-1))&&e.parentNode?l(t,n.name.slice(1,-1).replace(/[_\-]/g,".")).call({defineProperty:f},e,r,n.value):/\{\{.*\}\}/.test(n.value)?p(e,r,g(e,n.name),n.value.replace(/\{\{/g,"").replace(/\}\}/g,"")):p(e,r,g(e,(/^\(.+\)$/.test(n.name)||/^@.+$/.test(n.name)?"on":"")+n.name.replace(/^[\[\]\(\):@]/g,"").replace(/[\[\]\(\):@]$/g,"")),n.value),d.binding||setTimeout(function(){(/^\[.+\]$/.test(n.name)||/\{\{.*\}\}/.test(n.value))&&e.removeAttribute(n.name)},50)}),e.parentNode&&["SCRIPT"].indexOf(e.tagName)===-1&&m.apply(e,e.childNodes)}}function m(){Array.prototype.forEach.call(arguments,function(e){e instanceof Element?e.scope?e.scope()!==r&&r!==window&&(e.scope().__proto__=r,r.$eval(e.scope().$eval)):s(e,r):/\{\{.*\}\}/.test(e.data)&&p(e,r,"data",e.data.replace(/\{\{/g,"").replace(/\}\}/g,""))})}function y(e,t){function n(e,n,r){n?r?r.before?r.before(e):n.insertBefore&&n.insertBefore(e,r):n!==e.parentNode&&n.appendChild(e):e.parentNode&&(e.parentNode.removeChild(e),t.$destroy())}e.scope=function(){return t},e.update=function(t,r){e instanceof Array?e.forEach(function(e){n(e,t,r)}):n(e,t,r)},e.$emit=function(t){var n=Array.prototype.slice.apply(arguments);n[0]=document.createEvent("HTMLEvents"),n[0].initEvent(t,!0,!0),n[0].data=n,e instanceof Array?e.forEach(function(e){e.dispatchEvent(n[0])}):e.dispatchEvent(n[0])}}function g(e,t){function n(e){var t=e,n={class:"className"};return Object.keys(n).forEach(function(e){t=t.replace(e,n[e])}),t=t.split(/[_\-]/).map(function(e){return e[0].toLocaleUpperCase()+e.slice(1)}).join(""),t[0].toLocaleLowerCase()+t.slice(1)}function r(e){return e?Object.keys(e).concat(r(e.__proto__)):[]}var o=e;return t.split(".").map(function(t,i,a){var c=r(o).filter(function(e){return n(t).toLocaleLowerCase()===e.toLocaleLowerCase()}).pop();return c?(i<a.length-1&&(o=e[c]),c):t}).join(".")}if("string"==typeof o?(d.content.innerHTML="",location.hash="#"+o.replace(/\./g,"/"),o=null):"function"==typeof o&&(a=o,o=null),"function"==typeof r&&(a=r,r={}),"string"==typeof t[0]&&"object"==typeof t[1]&&(Object.keys(t[1]).forEach(function(e){t[0]=t[0].replace(new RegExp("\\{\\s*"+e+"\\s*\\}","g"),t[1][e]||"")}),t=t[0]),"string"==typeof t&&(t=function(e){var t=document.createElement("div");return t.innerHTML=e,Array.prototype.slice.call(t.children,0)}(t),t.forEach(function(e){(o||d.content).appendChild(e)})),r&&!(t instanceof Array)&&!(t instanceof HTMLElement))throw new Error("element必须是DOM元素。");return r=r||{},function(){if(!r.$eval||r.$eval===r.__proto__.$eval){if(Object.defineProperty(r,"$id",{value:++d.binding$id}),Object.defineProperty(r,"$destroy",{value:i(r)}),Object.defineProperty(r,"$eval",{value:i(r)}),Object.defineProperty(r,"$real",{value:function(){return JSON.parse(JSON.stringify(r)||"null")}}),Object.defineProperty(r,"$extend",{value:function(e,t){return v(r,e,t)}}),Object.defineProperty(r,"$value",{value:function(e,t){return l(r,e,t)}}),a&&a(r,t),r===e)return;Object.keys(r).filter(function(e){return"function"!=typeof r[e]&&!(r[e]instanceof Node)}).forEach(function(e){var t=r[e],n=c(r,e)||{};Object.defineProperty(r,e,{configurable:!0,enumerable:n.enumerable,set:function(e){t=e,n.set&&n.set(e),r.$eval()},get:function(){var e=n.get&&n.get();return"number"==typeof e?e:e||t}})})}}(),y(t,r),t instanceof Array?t.forEach(function(e){y(e,r),h(e)}):h(t),r.$eval(),t}function p(e,t,r,i){function a(){var o=/\|\s*[0-9a-zA-Z_$@]+\s*\(?\S*\)?/g,a=l(t,i.replace(o,""))||"";i.match(o)&&i.match(o).forEach(function(e){var r=n("filter."+e.split("(")[0].replace("|","").trim());if(r)if(e.split(/[\(\)]/g)[1]){var o=e.split(/[\(\)]/g)[1].split(",").map(function(e){return l(t,e.trim())});a=r.apply(n("filter"),[a].concat(o))}else a=r(a)}),l(e,r)!==a&&l(e,r,a)}function p(){"value"===r?(e.addEventListener("keyup",function(){l(t,i,l(e,r)),t.$eval()}),e.addEventListener("change",function(){l(t,i,l(e,r)),t.$eval()}),l(e,r,l(t,i))):e.addEventListener("click",function(n){"value"===r&&["INPUT","SELECT","TEXTAREA"].indexOf(n.target.nodeName)!==-1||l(t,i,l(e,r)),n.target.focus()})}e.parentNode&&(/^\s*on/.test(r)?function(){function n(n){t.$event=n||window.event,t.$element=e;var r=l(t,i);return delete t.$event,delete t.$element,r}if("onload"===r){var o=n();/^[0-9a-zA-Z\._$@]*$/.test(i)&&o&&(o.call(t,e),t.$eval())}else e.addEventListener(r.replace("on","").trim(),function(e){var r=n(e);/^[0-9a-zA-Z\._$@]*$/.test(i)&&r&&(r.apply(t,e.data||arguments),t.$eval())})}():/\S+:\S+/.test(r)?function(n){function a(e){return e instanceof Array&&u(e,p),e}function p(e){function r(e,t){function n(n,r,o,i){var a={$index:r};return Object.defineProperty(a,"$first",{value:0===o}),Object.defineProperty(a,"$last",{value:o+1===i}),t(n,r,e,a)}return/^\d+$/.test(e)?Array(+e).fill(1).map(function(e,t,r){return n(t,t,t,r.length)}):e.length?Array.prototype.map.call(e,function(e,t,r){return n(e,t,t,r.length)}):e&&"object"==typeof e?Array.prototype.map.call(Object.keys(e),function(t,r,o){return n(e[t],t,r,o.length)}):[]}v.forEach(function(e,t){e.e.update()}),v=r(e||[],function(i,a,c,u){var f={};return f.e&&f.e.scope().item===f.t?(f.e.update(m),f.e.scope().$eval()):(/^\d+$/.test(a)&&Object.defineProperty(u,"$index",{enumerable:!1,get:function(){return r(l(t,n[1])||[],function(e){return""+JSON.stringify(e)}).indexOf(""+JSON.stringify(i))}}),Object.defineProperty(u,n[0],{configurable:!0,enumerable:!0,get:function(){return o(e[a],i)},set:function(t){e[a]=t}}),u.__proto__=t,f.e=s(g,u),f.e.update(m,h),t.$eval(function(){u.$eval.apply(u,arguments)})),f})}var v=[],h=e.nextSibling,m=e.parentNode,y=c(t,i||n[1]),g=e.outerHTML.replace("["+r+']="'+i+'"',"");e.parentNode.removeChild(e),y.value=y.value||[],Object.defineProperty(t,n[1],{configurable:!0,enumerable:y.enumerable,get:function(){return y.get&&y.get()||y.value},set:function(e){y.set?y.set(e):y.value=e,p(a(e))}}),i&&f(t,i,function(){y=c(t,i||n[1]),p(a(l(t,i||n[1])))}),d.binding&&s(document.createComment(e.outerHTML)).update(m,h),p(a(l(t,i||n[1])))}(r.split(":")):/^[0-9a-zA-Z\._$@]*$/.test(i)?"function"==typeof l(t,i)?l(e,r,l(t,i)):function(){var n=i.split("."),a=n.pop(),u=c(n.length?l(t,n.join(".")):t,a);t.$eval(function(){l(e,r,l(t,i))}),p(),Object.defineProperty(n.length?l(t,n.join(".")):t,a,{configurable:!0,enumerable:u.enumerable,set:function(t){l(e,r,t),u.set?u.set(t):u.writable&&(u.value=t)},get:function(){return o("value"===r&&e.value,u.get&&u.get(),u.value)}})}():(f(t,i,a),t.$eval(a),p()))}var d={temp:{},data:{},load:[],binding$id:0};return window&&(d.files=[],d.data.$resource={},d.menu=document.createElement("div"),d.content=document.createElement("div"),d.menu.className="ehuanrum-menu",d.content.className="ehuanrum-content",window.addEventListener("load",function(){function e(e,r){if(n("router")&&!e?(document.body.appendChild(d.menu),document.body.appendChild(d.content)):document.body.appendChild(d.content),n("router")){var o=c.filter(function(e){return!!e}).join("/");t(o?"/"+o:r||"router.main",c.pop()||c.pop()||"default")}Object.defineProperty(n("router")||{},"goto",{value:t})}function t(e){if("number"==typeof e){var n=location.hash;n=e<0?i[i.length+e]:i[i.lastIndexOf(n)+e],arguments[0]=n.replace("#","")||"#/no-Found-"+Date.now(),t.apply(this,arguments)}else"string"==typeof e?(i.push(location.hash),location.hash="#"+e.replace(/^\s*router\./,"/"),arguments[0]=r[e.replace(/^\s*router\./,"/")],t.apply(this,arguments)):"function"==typeof e?(d.content.innerHTML="",o&&o.scope()&&o.scope().$destroy(),o=e.apply(this,Array.prototype.slice.call(arguments,1))):e||(d.content.innerHTML='<div style="position: absolute;top:10em;left:50%;">没有对应的页面,请确认输入的地址！</div>')}var r={},o=null,i=[],c=location.hash.replace("#","").split("/");(function(e){function t(e){return new Promise(function(t){if(/\.js$/.test(e)||/^https?:\/\//.test(e)){var n=document.createElement("script");n.src=e,n.onload=t,document.body.appendChild(n)}else if(/\.css$/.test(e)){var r=document.createElement("link");r.type="text/css",r.rel="stylesheet",r.href=e,r.onload=t,document.head.appendChild(r)}else fetch(e).then(function(e){return e.text()}).then(function(n){d.data.$resource[e]=n,t()}).catch(function(){t()})})}return new Promise(function(n){Promise.all(e.map(function(e){return t(e)})).then(n)})})(d.files).then(function(){s(document.body,window),s(d.menu,window),s(d.content,window),d.menu.appendChild(a(n("router")||{},r,t,"")),n("main")?n("main")(e,d.content):e()})})),n("filter",function(){return r}),n("binding",function(){return s}),n("value",function(){return l}),function(){return n}}(this,function(_obj,_str,_value){function getValue(e){return"object"==typeof e?JSON.stringify(e):/^\s*\d+\s*$/i.test(e)||/^\s*(true|false|null|undefined)\s*$/i.test(e)?e:JSON.stringify(e)}with(_obj){if(_value===undefined)return eval(_str);eval(_str+"="+getValue(_value))}})),function(e){"use strict";e("functions.color",function(){return function(e){if(e)return"number"!=typeof e&&(e=0,Array.prototype.forEach.call(""+e,function(t){e+=t.charCodeAt()})),"#"+new Date(1e4).setYear(e).toString(16).slice(-8,-2);for(var t=Math.floor(256*Math.random()*256*256).toString(16).slice(-6);t.length<6;)t=0+t;return"#"+t}}),e("functions.event",function(){return function(e){function t(e){return n.push(e),t}var n=[];return Object.create({in:t,out:function(e){e&&(n=n.filter(function(t){return"function"==typeof e&&t!==e||"string"==typeof e&&t.name!==e}))},fire:function(){var t=arguments;n.forEach(function(n){n.apply(e,t)})}})}}),e("functions.style",function(){var e=document.createElement("style");return e.id="functions.style",document.head.appendChild(e),function(t){e.innerHTML+="\r\n"+t}})}(window.$ehr),function(e){"use strict";e("random",function(){function e(o,i,a){if(a="function"==typeof a?a:t(),i)return n(""+i,function(t){var n=[];a(o);for(var r=0;r<t;r++)n.push(e(o,null,a));return n});if("string"==typeof o)return r(o,a);var c={};return Object.keys(o).forEach(function(t){var n=t.match(/:.*/);c[e(t.replace(n&&n[0],""),null,a)]=e(o[t],n&&n[0].replace(":","").trim(),a)}),c}function t(){var e=null,t={};return function(n){if(/^\d*\+\d*/.test(n))return t[e]=t[e]||(+n.split("+")[0]||1)-(+n.split("+")[1]||1),t[e]=t[e]+(+n.split("+")[1]||1),t[e];e=JSON.stringify(n)}}function n(e,t){return t=t||function(e){return e},e=e&&e.trim()||"1-100",e=e.split("-"),e[1]=e[1]||e[0],e=(Array(e[1].length).join("0")+Math.floor(+e[0]+Math.random()*(e[1]-e[0]))).slice(-e[1].length),t(e)}function r(e,t){function r(e){return/\-/.test(e)?n(e):/\+/.test(e)?t(e):o(e)||e}var a=e.match(/\[((?!\[).)*\]/g);return a&&a.forEach(function(t){if(/[\(\)\{\}]/.test(t)){var o=t.replace(/[\[\]]/g,"").split(/[\(\)\{\}]/);e=e.replace(t,n(o[3]||o[2],function(e){for(var t="",n=0;n<e;n++)t+=i(o[1]||"0-Z");return t}))}else{var a=t.replace(/[\[\]]/g,"").split(",").map(r);e=e.replace(t,a[Math.floor(Math.random()*a.length)])}}),e}function o(e){return{date:new Date,host:location.host}[e.toLocaleLowerCase()]}function i(e){for(;/\-/.test(e);){var t=e[e.indexOf("-")-1]||"",n=e[e.indexOf("-")+1]||"";e=e.replace(t+"-"+n,a.slice(a.indexOf(t||a[0]),a.indexOf(n||a[a.length-1])))}return e[Math.floor(Math.random()*e.length)]}var a="0123456789abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ";return e})}(window.$ehr);